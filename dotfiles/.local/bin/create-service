#! /usr/bin/env nu

def main [f: string --local] {
    let prefix = if $local {$"local-dotfiles/host-(hostname)"} else {"dotfiles"};
    let filepath = $"($env.SETUP_REPO)/($prefix)/.config/systemd/user/($f).service"
    cp $"($env.SETUP_REPO)/util/service-template" $filepath
    nvim $filepath;
    restow;
    systemctl enable --user $"($f).service"
    systemctl start --user $"($f).service"
    systemctl status --user $"($f).service"
}

